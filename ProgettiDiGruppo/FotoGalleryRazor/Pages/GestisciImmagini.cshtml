@page
@model GestisciImmaginiModel
@{
    ViewData["Title"] = "Gestisci Immagini";
    string url = HttpContext.Request.Path + HttpContext.Request.QueryString; //memorizzo url
}

<div class="container">
    <!-------------------------- titolo della pagina ---------------------------->
    <div class="text-center">
        <h1 class="display-4">@ViewData["Title"]</h1>
    </div>

    <!---------------------- tabella di modifica ---------------->
    <form method="get">
    <table class="table text-center table-striped align-middle mt-5">
        <thead>
            <tr>
                <th>Id</th>
                <th>Immagine</th>
                <th>Titolo</th>
                <th>Autore</th>
                <th>Data pubblicazione</th>
                <th>
                    <div class="dropdown text-center">
                        <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-tools" viewBox="0 0 16 16">
                            <path d="M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.27 3.27a.997.997 0 0 0 1.414 0l1.586-1.586a.997.997 0 0 0 0-1.414l-3.27-3.27a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3q0-.405-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814zm9.646 10.646a.5.5 0 0 1 .708 0l2.914 2.915a.5.5 0 0 1-.707.707l-2.915-2.914a.5.5 0 0 1 0-.708M3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026z"/>
                            </svg>
                        </button>
                        
                        <!---------------------- bottone aggiungi -------------------------->
                        <ul class="dropdown-menu p-0 ps-1 pb-1 pt-1" style="min-width: 8rem;">
                            <li><a class="dropdown-item" asp-page="/AggiungiImmagine" style="color: blue;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
                                </svg> Aggiungi</a>
                            </li>

                        <!---------------------- bottone modifica -------------------------->
                            <li><button type="submit" class="dropdown-item" asp-page="/ModificaImmagine">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-command" viewBox="0 0 16 16">
                                <path d="M3.5 2A1.5 1.5 0 0 1 5 3.5V5H3.5a1.5 1.5 0 1 1 0-3M6 5V3.5A2.5 2.5 0 1 0 3.5 6H5v4H3.5A2.5 2.5 0 1 0 6 12.5V11h4v1.5a2.5 2.5 0 1 0 2.5-2.5H11V6h1.5A2.5 2.5 0 1 0 10 3.5V5zm4 1v4H6V6zm1-1V3.5A1.5 1.5 0 1 1 12.5 5zm0 6h1.5a1.5 1.5 0 1 1-1.5 1.5zm-6 0v1.5A1.5 1.5 0 1 1 3.5 11z"/>
                                </svg> Modifica</button>
                            </li>

                        <!---------------------- bottone elimina -------------------------->
                            <li><button type="submit" class="dropdown-item" asp-page="/EliminaImmagine" style="color: red;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/>
                                </svg> Elimina</button>
                            </li>
                        </ul>
                    </div></th>
            </tr>
        <tbody>
            @foreach (var img in Model.Immagini)
                {
                    //memorizzo id diversi per ogni modale
                    string idModale = "modal" + img.Id.ToString();
                    <tr>
                        <td>@img.Id</td>
                        <td>
                        <!-- inserimento della modale per visualizzare la foto -->
                        <!-- Button trigger modal -->
                        <a type="button" data-bs-toggle="modal" data-bs-target="#@idModale">
                            <img class="img-classifica" src="@img.Path" alt="@img.Titolo" width="80" height="60" />
                        </a>

                        <!-- Modale -->
                        <div class="modal fade" id="@idModale" tabindex="-1" aria-labelledby="exampleModalLabel"
                            aria-hidden="true">
                            <div class="modal-dialog modal-xl modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header justify-content-center">
                                        <h1 class="modal-title fs-5 text-center
                                         m-auto" id="exampleModalLabel">@img.Titolo
                                        </h1>
                                        <button type="button" class="btn-close end-0" data-bs-dismiss="modal"
                                            aria-label="Close">
                                        </button>
                                    </div>

                                    <div class="modal-body">
                                        <img class="modal-img img-fluid" src="@img.Path" alt="@img.Titolo" />
                                        <!-- Stella e voto sopra l'immagine -->
                                        <div class="modal-voto">
                                            <span class="bi bi-star-fill"></span>
                                            <span class="index-voto">@img.Voto</span>
                                        </div>
                                    </div>

                                    <div class="modal-footer">
                                        <a class="btn btn-primary" asp-page="/Immagine" asp-route-id="@img.Id" asp-route-urlback="@url">Dettaglio
                                            immgine
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </td>
                        <td>@img.Titolo</td>
                        <td>@img.Autore</td>
                        <td>@img.Data.ToString("d")</td>
                        <td><input type="checkbox" name="Selezione" value="@img.Id"></td>
                        
                    </tr>
                }
        </tbody>
        </thead>
    </table>
    </form>

    <!---------------------------- tasti paginazione -------------------------->
    <nav class="mt-4" aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <li class="page-item">
                <a class="page-link" aria-label="Previous" asp-page="/GestisciImmagini" 
                    asp-route-pagegestione="1" >
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            @for (int i = 1; i <= Model.NumeroPagine; i++)
            {
                if (i == Model.PageGestione)
                {
                    <li class="page-item active"><a class="page-link" asp-page="/GestisciImmagini" 
                        asp-route-pagegestione="@i" >@i</a></li>
                }
                else
                {
                    <li class="page-item"><a class="page-link" asp-page="/GestisciImmagini" 
                        asp-route-pagegestione="@i">@i</a></li>
                }
                
            }
            <li class="page-item">
                <a class="page-link" aria-label="Next" asp-page="/GestisciImmagini" 
                    asp-route-pagegestione="@Model.NumeroPagine" >
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>

</div>